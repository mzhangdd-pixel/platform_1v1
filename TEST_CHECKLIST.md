# 🧪 手柄功能测试清单

## 测试前准备

- [ ] 已连接 Switch 手柄到电脑
- [ ] 手柄在系统中被识别 (Windows: 设备管理器 / macOS: 蓝牙设置)
- [ ] 使用 Chrome 或 Edge 浏览器
- [ ] 已访问 [https://gamepad-tester.com/](https://gamepad-tester.com/) 验证手柄工作

## 核心功能测试

### 1. 连接检测
- [ ] 打开游戏页面,看到 "🎮 P1 手柄已连接" 提示
- [ ] 提示显示在左上角,绿色背景
- [ ] 提示 3 秒后自动消失
- [ ] 按 F12 打开控制台,看到 `[GamepadHandler] Player 1 手柄已连接` 日志

### 2. 摇杆移动
- [ ] 推动右摇杆向左,角色向左移动
- [ ] 推动右摇杆向右,角色向右移动
- [ ] 摇杆在中心位置时,角色停止移动 (无漂移)
- [ ] 轻微推动摇杆 (<15%),角色不移动 (死区生效)
- [ ] 角色移动方向与摇杆方向一致

### 3. 按钮功能
- [ ] **B 键**: 角色跳跃 (在地面时)
- [ ] **A 键**: 发动普通攻击
- [ ] **Y 键**: 释放技能
- [ ] **X 键**: 使用大招 (资源充足时)
- [ ] **ZL 键**: 与对手换位

### 4. 边沿检测
- [ ] 按住 B 键,角色只跳一次 (不连续跳)
- [ ] 按住 A 键,只发动一次攻击 (有冷却时间)
- [ ] 释放按钮后,再次按下可触发新动作

### 5. 键盘手柄共存
- [ ] 使用键盘 A/D 键移动,角色正常移动
- [ ] 推动摇杆,摇杆输入覆盖键盘输入
- [ ] 停止摇杆输入,键盘输入恢复作用
- [ ] 按键盘 X 键攻击,按手柄 A 键攻击,都能正常工作

### 6. 游戏状态集成
- [ ] 选择法师,手柄攻击发射火球
- [ ] 选择战士,手柄技能触发冲锋
- [ ] 角色受到伤害时,手柄仍可控制
- [ ] 角色死亡重生后,手柄继续工作
- [ ] 游戏结束后,手柄停止响应

### 7. 断开重连
- [ ] 游戏中关闭手柄蓝牙,看到 "❌ P1 手柄已断开" 提示
- [ ] 重新连接手柄,看到 "🎮 P1 手柄已连接" 提示
- [ ] 重连后手柄功能正常

## 高级功能测试

### 8. 死区算法
- [ ] 摇杆轻微偏离中心 (<15%),角色不移动
- [ ] 摇杆推到 20%,角色开始移动
- [ ] 摇杆推到 100%,角色全速移动
- [ ] 快速从 100% 回到 0%,角色立即停止

### 9. 性能测试
- [ ] 打开 F12 控制台,查看 FPS (应稳定在 60)
- [ ] 摇杆快速移动,画面无卡顿
- [ ] 同时移动摇杆和按多个按钮,输入无延迟
- [ ] 长时间游戏 (5 分钟+),手柄响应稳定

### 10. 浏览器兼容性
- [ ] Chrome: 手柄正常工作
- [ ] Edge: 手柄正常工作
- [ ] Firefox: 手柄正常工作 (可选)
- [ ] Safari (macOS): 手柄正常工作 (可选)

## 故障排查测试

### 11. 错误处理
- [ ] 游戏启动前连接手柄,正常识别
- [ ] 游戏启动后连接手柄,自动识别
- [ ] 刷新页面 (F5),手柄重新连接
- [ ] 强制刷新 (Ctrl+F5),手柄重新初始化

### 12. 控制台日志
打开 F12 控制台,检查以下日志:

- [ ] `[GamepadHandler] Player 1 手柄已连接: [手柄名称]`
- [ ] `[GamepadHandler] Player 1 开始轮询`
- [ ] `[Gamepad Integration] 手柄系统已初始化`
- [ ] `[Gamepad Integration] 补丁已加载`
- [ ] 无错误信息 (红色文本)

## 用户体验测试

### 13. 流畅度
- [ ] 摇杆移动感觉自然,无延迟
- [ ] 按键响应即时,无卡顿
- [ ] 死区设置合理,不会误触
- [ ] 整体体验优于/等于键盘控制

### 14. UI 反馈
- [ ] 连接提示醒目但不干扰游戏
- [ ] 断开提示及时准确
- [ ] 文档清晰易懂

## 测试结果记录

### 测试环境
- **操作系统**: ___________ (Windows 11 / macOS Sonoma 等)
- **浏览器**: ___________ (Chrome 120 / Edge 120 等)
- **手柄型号**: ___________ (Switch Pro / Xbox Series X 等)
- **连接方式**: ___________ (蓝牙 / USB-C)

### 通过率
- 总测试项: _____ / 50
- 核心功能: _____ / 7
- 高级功能: _____ / 4
- 故障排查: _____ / 2

### 已知问题
1. _______________________________
2. _______________________________
3. _______________________________

### 测试结论
- [ ] ✅ 通过 - 可以正式发布
- [ ] ⚠️ 部分通过 - 需要修复问题: _______
- [ ] ❌ 未通过 - 需要重大修复

---

**测试日期**: ___________
**测试人员**: ___________
**签名**: ___________
